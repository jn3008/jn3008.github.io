(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3291:(t,e,i)=>{"use strict";i.d(e,{default:()=>z});var n=i(5155),s=i(2115),o=i(5339),a=i(7548);let r=new o.Gu$(.02,6,5),l=new o.O9p(.6154797086703873,-(.25*Math.PI),0,"XYZ"),u=new o.kn4().makeRotationFromEuler(l),p=new o.V9B({color:new o.Q1f("#ffffff"),depthTest:!0,depthWrite:!0}),m=new o.V9B({color:new o.Q1f("#000000")});function h(){let t=getComputedStyle(document.documentElement),e=t.getPropertyValue("--color-back").trim();console.log("back: ",e);let i=t.getPropertyValue("--color-primary").trim(),n=t=>t.replace(/rgb\((\d+)\s+(\d+)\s+(\d+)\)/,"rgb($1,$2,$3)");m.color.set(n(e)||"#000"),p.color.set(n(i)||"#fff"),console.log("globalCubeMaterial.color ",m.color)}function c(t,e){return t.applyAxisAngle(new o.Pq0(1,0,0),e)}function d(t,e){return t.applyAxisAngle(new o.Pq0(0,1,0),e)}function w(t){return c(d(t.multiplyScalar(.57),.25*Math.PI),-.6154797086703873)}function f(t,e,i){return-e<1+t+i&&e-i-1<-t}function y(t,e,i,n,s){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=n+(s-n)*(t-e)/(i-e);if(!o)return a;if(s<n){if(a<s)return s;if(a>n)return n}else{if(a>s)return s;if(a<n)return n}return a}let k=t=>t*t,b=[0,.55,.85],_=[1,.18,.035];function M(t){let e=Math.cos(-(.25*Math.PI)),i=-.5773502691896257*Math.sin(-(.25*Math.PI));return new o.Pq0(Math.round(t.x/e),Math.round(-i*t.x/e/.816496580927726+t.y/.816496580927726),0)}function P(t,e){return Math.floor(Math.random()*(e-t+1))+t}class g{update(t){var e;if(!this.duration)return;this.t+=t;let i=this.t/this.duration;i=function(t){for(let e=0;e<3;e++)if(t<b[e])return 1-_[e-1]*(1-k(y(t,b[e-1],b[e],1==e?0:-1,1)));return 1-(1-Math.min(1,Math.max(0,k(y(t,b[2],1,-1,1)))))*_[2]}(i=(e=i)<.5?.5*Math.pow(2*e,2):1-.5*Math.pow(2*(1-e),2));let n=.57*this.cube_size,s=new o.kn4().identity();s.premultiply(this.action(i)),s.premultiply(u),s.premultiply(new o.kn4().makeTranslation(this.start_pos.x,this.start_pos.y,this.start_pos.z)),s.premultiply(new o.kn4().makeScale(n,n,n)),this.object.position.set(0,0,0),this.object.rotation.set(0,0,0),this.object.scale.set(1,1,1),this.object.applyMatrix4(s);let a=new o.Pq0().setFromMatrixScale(s);if(this.object.scale.set(a.x,a.y,a.z),this.points&&this.baseDotPositions){s.decompose(this._pos,this._quat,this._scl),this.points.position.copy(this._pos),this.points.quaternion.copy(this._quat),this.points.scale.set(1,1,1),this.points.position.z+=this.dotZBias;let t=this.baseDotPositions.length/3;for(let e=0;e<t;e++)this._dummy.position.set(this.baseDotPositions[3*e+0]*this._scl.x,this.baseDotPositions[3*e+1]*this._scl.y,this.baseDotPositions[3*e+2]*this._scl.z),this._dummy.rotation.set(0,0,0),this._dummy.scale.set(1,1,1),this._dummy.updateMatrix(),this.points.setMatrixAt(e,this._dummy.matrix);this.points.instanceMatrix.needsUpdate=!0}}getStartPos(){return new o.Pq0().copy(this.start_pos).multiplyScalar(this.cube_size)}getEndPos(){return new o.Pq0().applyMatrix4(this.action(1).premultiply(u)).add(this.start_pos).multiplyScalar(this.cube_size)}make_new_cube(t,e){if(this.t=0,this.cube_size=P(1,3),this.mvm=P(0,10),this.time_offset=P(0,1),this.duration=.08+.1*((this.cube_size-1)/4),this.points&&(this.points.geometry.dispose(),this.points=null),t){let e=.57*this.cube_size;this.start_pos=t.clone().multiplyScalar(1/Math.max(e,1e-6))}else{let t=function(t){let e=P(-t,t),i=P(-t,t);for(;!f(e,i,t);)e=P(-t,t),i=P(-t,t);var n=new o.I9Y(e,i);let s=Math.cos(-(.25*Math.PI*1)),a=-.5773502691896257*Math.sin(-(.25*Math.PI*1));return new o.Pq0(Math.round(s*n.x),Math.round(a*n.x-.816496580927726*n.y),0)}(Math.floor(.4*this.bg_grid_size)-1);this.start_pos=t}let i=M(this.getStartPos()),n=M(this.getEndPos());if(e&&e.length>0){for(let t of[i,n])for(let i of e)for(let e of[M(i.getStartPos()),M(i.getEndPos())])for(let n=-this.cube_size;n<this.cube_size+1;n++)for(let s=-this.cube_size;s<this.cube_size+1;s++)if(f(n,s,this.cube_size-1)&&f(n-t.x+e.x,s-t.y+e.y,i.cube_size))return!1}let s=[];for(let t=0;t<=this.cube_size;t++)for(let e=0;e<=this.cube_size;e++)for(let i=0;i<=this.cube_size;i++)Math.min(t,e,i)>0&&Math.max(t,e,i)<this.cube_size||s.push(t/this.cube_size-.5,e/this.cube_size-.5,i/this.cube_size-.5);this.baseDotPositions=new Float32Array(s);let a=s.length/3,l=new o.ZLX(r,p,a);for(let t=0;t<a;t++){let e=s[3*t+0],i=s[3*t+1],n=s[3*t+2];this._dummy.position.set(e,i,n),this._dummy.rotation.set(0,0,0),this._dummy.scale.set(1,1,1),this._dummy.updateMatrix(),l.setMatrixAt(t,this._dummy.matrix)}return l.instanceMatrix.needsUpdate=!0,l.instanceMatrix.setUsage(o.Vnu),l.renderOrder=999,l.frustumCulled=!1,this.points=l,this.update(0),!0}action(t){let e=new o.kn4().identity();switch(this.mvm){case 0:e.premultiply(new o.kn4().makeTranslation(-.5,.5,0)),e.premultiply(new o.kn4().makeRotationZ(-(.5*Math.PI)*t)),e.premultiply(new o.kn4().makeTranslation(.5,-.5,0));break;case 1:e.premultiply(new o.kn4().makeTranslation(0,.5,-.5)),e.premultiply(new o.kn4().makeRotationX(.5*Math.PI*t)),e.premultiply(new o.kn4().makeTranslation(0,-.5,.5));break;case 2:e.premultiply(new o.kn4().makeTranslation(.5,.5,0)),e.premultiply(new o.kn4().makeRotationZ(-(.5*Math.PI)*t)),e.premultiply(new o.kn4().makeTranslation(-.5,-.5,0));break;case 3:e.premultiply(new o.kn4().makeTranslation(0,.5,.5)),e.premultiply(new o.kn4().makeRotationX(.5*Math.PI*t)),e.premultiply(new o.kn4().makeTranslation(0,-.5,-.5));break;case 4:e.premultiply(new o.kn4().makeTranslation(-.5,0,.5)),e.premultiply(new o.kn4().makeRotationY(.5*Math.PI*t)),e.premultiply(new o.kn4().makeTranslation(.5,0,-.5));break;case 5:e.premultiply(new o.kn4().makeTranslation(.5,0,-.5)),e.premultiply(new o.kn4().makeRotationY(-(.5*Math.PI)*t)),e.premultiply(new o.kn4().makeTranslation(-.5,0,.5));break;case 6:case 7:e.premultiply(new o.kn4().makeTranslation(.5,0,.5)),e.premultiply(new o.kn4().makeRotationY(.5*Math.PI*t)),e.premultiply(new o.kn4().makeTranslation(-.5,0,-.5));break;case 8:e.premultiply(new o.kn4().makeTranslation(.5,0,0)),e.premultiply(new o.kn4().makeScale(t,1,1)),e.premultiply(new o.kn4().makeTranslation(-.5,0,0));break;case 9:e.premultiply(new o.kn4().makeTranslation(0,0,.5)),e.premultiply(new o.kn4().makeScale(1,1,t)),e.premultiply(new o.kn4().makeTranslation(0,0,-.5));break;case 10:e.premultiply(new o.kn4().makeTranslation(0,.5,0)),e.premultiply(new o.kn4().makeScale(1,t,1)),e.premultiply(new o.kn4().makeTranslation(0,-.5,0))}return e}constructor(t){this.t=0,this.bg_grid_size=5,this.squish=.5,this.dotZBias=.1,this.points=null,this.baseDotPositions=null,this._dummy=new o.B69,this._pos=new o.Pq0,this._quat=new o.PTz,this._scl=new o.Pq0;let e=new o.iNn(1,1,1);this.object=new o.eaF(e,m),this.object.position.set(0,0,0),this.object.userData={cube:this}}}var x=i(3265);function z(){let t=(0,s.useRef)(null),{resolved_theme:e}=(0,x.w)();return(0,s.useEffect)(()=>{let e=t.current,i=new o.Z58,n=new o.qUd(-3,3,3,-3,-100,100);n.position.set(0,0,10),n.lookAt(0,0,0);let s=new a.JeP({antialias:!0,alpha:!0});s.setPixelRatio(Math.min(window.devicePixelRatio,1.5)),s.domElement.style.display="block",s.domElement.style.width="100%",s.domElement.style.height="100%",e.appendChild(s.domElement),h();let l=null;function u(t){let e=d(c(t,.6154797086703873),-(.25*Math.PI)).multiplyScalar(1.7543859649122808);e.x=Math.round(e.x),e.y=Math.round(e.y),e.z=Math.round(e.z);let i=w(e);return i.z=0,i}let y=[];for(let t=-24;t<25;t++)for(let e=-24;e<25;e++)if(f(t,e,24)){let i=w(new o.Pq0(t,0,e));y.push(i.x,i.y,-50)}l=new o.ZLX(r,p,y.length/3);let k=new o.B69;for(let t=0;t<y.length;t+=3)k.position.set(y[t+0],y[t+1],y[t+2]),k.updateMatrix(),l.setMatrixAt(t/3,k.matrix);l.instanceMatrix.needsUpdate=!0,i.add(l);let b=[],_=!1,M=new o.tBo,P=new o.I9Y,x=new o.Zcv(new o.Pq0(0,0,1),0),z=new o.Pq0;function v(t){let e=s.domElement.getBoundingClientRect();return P.x=(t.clientX-e.left)/e.width*2-1,P.y=-(2*((t.clientY-e.top)/e.height))+1,M.setFromCamera(P,n),M.ray.intersectPlane(x,z),z.clone()}function E(t){return t.x>=n.left&&t.x<=n.right&&t.y>=n.bottom&&t.y<=n.top}function T(t){if(b.length>=4)return;let e=new g(i);e.bg_grid_size=5,e.make_new_cube(t,b)&&(e.object&&i.add(e.object),e.points&&i.add(e.points),b.push(e))}function q(t){if(!_)return;let e=v(t);if(!E(e))return;let i=u(e);if(i){for(let t=0;t<4;t++)T(i);_=!1}}function I(t){if(console.log("pointer"),!_)return;let e=v(t);if(console.log(e),!E(e))return;let i=u(e);i&&(T(i),_=!1)}s.domElement.addEventListener("pointermove",q),s.domElement.addEventListener("pointerdown",I),T(new o.Pq0(0,0,0));let j=()=>{let t=e.clientWidth||300,i=e.clientHeight||300;s.setSize(t,i,!1);let o=t/i;n.left=-6*o/2,n.right=6*o/2,n.top=3,n.bottom=-3,n.updateProjectionMatrix()};window.addEventListener("resize",j),j();let S=0,A=performance.now(),R=t=>{S=requestAnimationFrame(R);let e=(t-A)/1e3*.1;A=t;for(let t=b.length-1;t>=0;t--){let n=b[t];n.update(e),n.t>=n.duration&&(n.points&&(i.remove(n.points),n.points.geometry.dispose(),n.points=null),i.remove(n.object),n.object.geometry.dispose(),b.splice(t,1))}_=b.length<4,s.render(i,n)};return R(A),()=>{for(let t of(cancelAnimationFrame(S),window.removeEventListener("resize",j),s.domElement.removeEventListener("pointermove",q),s.domElement.removeEventListener("pointerdown",I),e.removeChild(s.domElement),s.dispose(),b))t.points&&t.points.geometry.dispose(),t.object.geometry.dispose();l&&l.geometry.dispose(),m.dispose(),p.dispose()}},[]),(0,s.useEffect)(()=>{let t=requestAnimationFrame(()=>{h()});return()=>cancelAnimationFrame(t)},[e]),(0,n.jsx)("div",{ref:t,className:"w-full h-full overflow-hidden"})}},6376:(t,e,i)=>{Promise.resolve().then(i.bind(i,3291)),Promise.resolve().then(i.bind(i,1039))}},t=>{t.O(0,[974],()=>{[33,323,315,270].map(t.E)},5),t.O(0,[367,831,868,39,441,255,358],()=>t(t.s=6376)),_N_E=t.O()}]);