(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3291:(e,t,i)=>{"use strict";i.d(t,{default:()=>z});var n=i(5155),s=i(2115),o=i(5339),r=i(7548);let l=new o.Gu$(.02,6,5),a=new o.O9p(.6154797086703873,-(.25*Math.PI),0,"XYZ"),u=new o.kn4().makeRotationFromEuler(a),p=new o.V9B({color:new o.Q1f("#ffffff"),depthTest:!0,depthWrite:!0}),m=new o.V9B({color:new o.Q1f("#000000")});function h(){let e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--color-back").trim();console.log("back: ",t);let i=e.getPropertyValue("--color-primary").trim(),n=e=>e.replace(/rgb\((\d+)\s+(\d+)\s+(\d+)\)/,"rgb($1,$2,$3)");m.color.set(n(t)||"#000"),p.color.set(n(i)||"#fff"),console.log("globalCubeMaterial.color ",m.color)}function c(e,t){return e.applyAxisAngle(new o.Pq0(1,0,0),t)}function d(e,t){return e.applyAxisAngle(new o.Pq0(0,1,0),t)}function w(e){return c(d(e.multiplyScalar(.57),.25*Math.PI),-.6154797086703873)}function f(e,t,i){return-t<1+e+i&&t-i-1<-e}function y(e,t,i,n,s){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=n+(s-n)*(e-t)/(i-t);if(!o)return r;if(s<n){if(r<s)return s;if(r>n)return n}else{if(r>s)return s;if(r<n)return n}return r}let k=e=>e*e,b=[0,.55,.85],_=[1,.18,.035];function P(e){let t=Math.cos(-(.25*Math.PI)),i=-.5773502691896257*Math.sin(-(.25*Math.PI));return new o.Pq0(Math.round(e.x/t),Math.round(-i*e.x/t/.816496580927726+e.y/.816496580927726),0)}function M(e,t){return Math.floor(Math.random()*(t-e+1))+e}class g{update(e){var t;if(!this.duration)return;this.t+=e;let i=this.t/this.duration;i=function(e){for(let t=0;t<3;t++)if(e<b[t])return 1-_[t-1]*(1-k(y(e,b[t-1],b[t],1==t?0:-1,1)));return 1-(1-Math.min(1,Math.max(0,k(y(e,b[2],1,-1,1)))))*_[2]}(i=(t=i)<.5?.5*Math.pow(2*t,2):1-.5*Math.pow(2*(1-t),2));let n=.57*this.cube_size,s=new o.kn4().identity();s.premultiply(this.action(i)),s.premultiply(u),s.premultiply(new o.kn4().makeTranslation(this.start_pos.x,this.start_pos.y,this.start_pos.z)),s.premultiply(new o.kn4().makeScale(n,n,n)),this.object.position.set(0,0,0),this.object.rotation.set(0,0,0),this.object.scale.set(1,1,1),this.object.applyMatrix4(s);let r=new o.Pq0().setFromMatrixScale(s);if(this.object.scale.set(r.x,r.y,r.z),this.points&&this.baseDotPositions){s.decompose(this._pos,this._quat,this._scl),this.points.position.copy(this._pos),this.points.quaternion.copy(this._quat),this.points.scale.set(1,1,1),this.points.position.z+=this.dotZBias;let e=this.baseDotPositions.length/3;for(let t=0;t<e;t++)this._dummy.position.set(this.baseDotPositions[3*t+0]*this._scl.x,this.baseDotPositions[3*t+1]*this._scl.y,this.baseDotPositions[3*t+2]*this._scl.z),this._dummy.rotation.set(0,0,0),this._dummy.scale.set(1,1,1),this._dummy.updateMatrix(),this.points.setMatrixAt(t,this._dummy.matrix);this.points.instanceMatrix.needsUpdate=!0}}getStartPos(){return new o.Pq0().copy(this.start_pos).multiplyScalar(this.cube_size)}getEndPos(){return new o.Pq0().applyMatrix4(this.action(1).premultiply(u)).add(this.start_pos).multiplyScalar(this.cube_size)}make_new_cube(e,t){if(this.t=0,this.cube_size=M(1,3),this.mvm=M(0,10),this.time_offset=M(0,1),this.duration=.08+.1*((this.cube_size-1)/4),this.points&&(this.points.geometry.dispose(),this.points=null),e){let t=.57*this.cube_size;this.start_pos=e.clone().multiplyScalar(1/Math.max(t,1e-6))}else{let e=function(e){let t=M(-e,e),i=M(-e,e);for(;!f(t,i,e);)t=M(-e,e),i=M(-e,e);var n=new o.I9Y(t,i);let s=Math.cos(-(.25*Math.PI*1)),r=-.5773502691896257*Math.sin(-(.25*Math.PI*1));return new o.Pq0(Math.round(s*n.x),Math.round(r*n.x-.816496580927726*n.y),0)}(Math.floor(.4*this.bg_grid_size)-1);this.start_pos=e}let i=P(this.getStartPos()),n=P(this.getEndPos());if(t&&t.length>0){for(let e of[i,n])for(let i of t)for(let t of[P(i.getStartPos()),P(i.getEndPos())])for(let n=-this.cube_size;n<this.cube_size+1;n++)for(let s=-this.cube_size;s<this.cube_size+1;s++)if(f(n,s,this.cube_size-1)&&f(n-e.x+t.x,s-e.y+t.y,i.cube_size))return!1}let s=[];for(let e=0;e<=this.cube_size;e++)for(let t=0;t<=this.cube_size;t++)for(let i=0;i<=this.cube_size;i++)Math.min(e,t,i)>0&&Math.max(e,t,i)<this.cube_size||s.push(e/this.cube_size-.5,t/this.cube_size-.5,i/this.cube_size-.5);this.baseDotPositions=new Float32Array(s);let r=s.length/3,a=new o.ZLX(l,p,r);for(let e=0;e<r;e++){let t=s[3*e+0],i=s[3*e+1],n=s[3*e+2];this._dummy.position.set(t,i,n),this._dummy.rotation.set(0,0,0),this._dummy.scale.set(1,1,1),this._dummy.updateMatrix(),a.setMatrixAt(e,this._dummy.matrix)}return a.instanceMatrix.needsUpdate=!0,a.instanceMatrix.setUsage(o.Vnu),a.renderOrder=999,a.frustumCulled=!1,this.points=a,this.update(0),!0}action(e){let t=new o.kn4().identity();switch(this.mvm){case 0:t.premultiply(new o.kn4().makeTranslation(-.5,.5,0)),t.premultiply(new o.kn4().makeRotationZ(-(.5*Math.PI)*e)),t.premultiply(new o.kn4().makeTranslation(.5,-.5,0));break;case 1:t.premultiply(new o.kn4().makeTranslation(0,.5,-.5)),t.premultiply(new o.kn4().makeRotationX(.5*Math.PI*e)),t.premultiply(new o.kn4().makeTranslation(0,-.5,.5));break;case 2:t.premultiply(new o.kn4().makeTranslation(.5,.5,0)),t.premultiply(new o.kn4().makeRotationZ(-(.5*Math.PI)*e)),t.premultiply(new o.kn4().makeTranslation(-.5,-.5,0));break;case 3:t.premultiply(new o.kn4().makeTranslation(0,.5,.5)),t.premultiply(new o.kn4().makeRotationX(.5*Math.PI*e)),t.premultiply(new o.kn4().makeTranslation(0,-.5,-.5));break;case 4:t.premultiply(new o.kn4().makeTranslation(-.5,0,.5)),t.premultiply(new o.kn4().makeRotationY(.5*Math.PI*e)),t.premultiply(new o.kn4().makeTranslation(.5,0,-.5));break;case 5:t.premultiply(new o.kn4().makeTranslation(.5,0,-.5)),t.premultiply(new o.kn4().makeRotationY(-(.5*Math.PI)*e)),t.premultiply(new o.kn4().makeTranslation(-.5,0,.5));break;case 6:case 7:t.premultiply(new o.kn4().makeTranslation(.5,0,.5)),t.premultiply(new o.kn4().makeRotationY(.5*Math.PI*e)),t.premultiply(new o.kn4().makeTranslation(-.5,0,-.5));break;case 8:t.premultiply(new o.kn4().makeTranslation(.5,0,0)),t.premultiply(new o.kn4().makeScale(e,1,1)),t.premultiply(new o.kn4().makeTranslation(-.5,0,0));break;case 9:t.premultiply(new o.kn4().makeTranslation(0,0,.5)),t.premultiply(new o.kn4().makeScale(1,1,e)),t.premultiply(new o.kn4().makeTranslation(0,0,-.5));break;case 10:t.premultiply(new o.kn4().makeTranslation(0,.5,0)),t.premultiply(new o.kn4().makeScale(1,e,1)),t.premultiply(new o.kn4().makeTranslation(0,-.5,0))}return t}constructor(e){this.t=0,this.bg_grid_size=5,this.squish=.5,this.dotZBias=.1,this.points=null,this.baseDotPositions=null,this._dummy=new o.B69,this._pos=new o.Pq0,this._quat=new o.PTz,this._scl=new o.Pq0;let t=new o.iNn(1,1,1);this.object=new o.eaF(t,m),this.object.position.set(0,0,0),this.object.userData={cube:this}}}var x=i(3265);function z(){let e=(0,s.useRef)(null),{resolved_theme:t}=(0,x.w)();return(0,s.useEffect)(()=>{let t=e.current,i=new o.Z58,n=new o.qUd(-3,3,3,-3,-100,100);n.position.set(0,0,10),n.lookAt(0,0,0);let s=new r.JeP({antialias:!0,powerPreference:"low-power",preserveDrawingBuffer:!1,alpha:!0});s.setPixelRatio(j()),s.domElement.style.display="block",s.domElement.style.width="100%",s.domElement.style.height="100%",t.appendChild(s.domElement),h();let a=null;function u(e){let t=d(c(e,.6154797086703873),-(.25*Math.PI)).multiplyScalar(1.7543859649122808);t.x=Math.round(t.x),t.y=Math.round(t.y),t.z=Math.round(t.z);let i=w(t);return i.z=0,i}let y=[];for(let e=-24;e<25;e++)for(let t=-24;t<25;t++)if(f(e,t,24)){let i=w(new o.Pq0(e,0,t));y.push(i.x,i.y,-50)}a=new o.ZLX(l,p,y.length/3);let k=new o.B69;for(let e=0;e<y.length;e+=3)k.position.set(y[e+0],y[e+1],y[e+2]),k.updateMatrix(),a.setMatrixAt(e/3,k.matrix);a.instanceMatrix.needsUpdate=!0,i.add(a);let b=[],_=!1,P=new o.tBo,M=new o.I9Y,x=new o.Zcv(new o.Pq0(0,0,1),0),z=new o.Pq0;function v(e){let t=s.domElement.getBoundingClientRect();return M.x=(e.clientX-t.left)/t.width*2-1,M.y=-(2*((e.clientY-t.top)/t.height))+1,P.setFromCamera(M,n),P.ray.intersectPlane(x,z),z.clone()}function E(e){return e.x>=n.left&&e.x<=n.right&&e.y>=n.bottom&&e.y<=n.top}function T(e){if(b.length>=4)return;let t=new g(i);t.bg_grid_size=5,t.make_new_cube(e,b)&&(t.object&&i.add(t.object),t.points&&i.add(t.points),b.push(t))}function q(e){if(!_)return;let t=v(e);if(!E(t))return;let i=u(t);if(i){for(let e=0;e<4;e++)T(i);_=!1}}function I(e){if(console.log("pointer"),!_)return;let t=v(e);if(console.log(t),!E(t))return;let i=u(t);i&&(T(i),_=!1)}function j(){var e,t;let i=null!=(t=null==(e=window.visualViewport)?void 0:e.scale)?t:1;return(window.devicePixelRatio||1)*i}s.domElement.addEventListener("pointermove",q),s.domElement.addEventListener("pointerdown",I),T(new o.Pq0(0,0,0));let S=()=>{let e=t.clientWidth||300,i=t.clientHeight||300,o=j();s.setPixelRatio(o),s.setSize(e,i,!1);let r=e/i;n.left=-6*r/2,n.right=6*r/2,n.top=3,n.bottom=-3,n.updateProjectionMatrix()};window.addEventListener("resize",S),S();let A=0,R=performance.now(),B=e=>{A=requestAnimationFrame(B);let t=(e-R)/1e3*.1;R=e;for(let e=b.length-1;e>=0;e--){let n=b[e];n.update(t),n.t>=n.duration&&(n.points&&(i.remove(n.points),n.points.geometry.dispose(),n.points=null),i.remove(n.object),n.object.geometry.dispose(),b.splice(e,1))}_=b.length<4,s.render(i,n)};return B(R),()=>{for(let e of(cancelAnimationFrame(A),window.removeEventListener("resize",S),s.domElement.removeEventListener("pointermove",q),s.domElement.removeEventListener("pointerdown",I),t.removeChild(s.domElement),s.dispose(),b))e.points&&e.points.geometry.dispose(),e.object.geometry.dispose();a&&a.geometry.dispose(),m.dispose(),p.dispose()}},[]),(0,s.useEffect)(()=>{let e=requestAnimationFrame(()=>{h()});return()=>cancelAnimationFrame(e)},[t]),(0,n.jsx)("div",{ref:e,className:"w-full h-full overflow-hidden"})}},8760:(e,t,i)=>{Promise.resolve().then(i.bind(i,3291)),Promise.resolve().then(i.bind(i,1039)),Promise.resolve().then(i.bind(i,6174))}},e=>{e.O(0,[974],()=>{[33,323,315,270].map(e.E)},5),e.O(0,[367,831,868,39,441,255,358],()=>e(e.s=8760)),_N_E=e.O()}]);